# Guair.app Environment Variables - SECURE TEMPLATE
# PCI-DSS Compliant Configuration

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Next.js Configuration
NODE_ENV=production
NEXT_PUBLIC_API_URL=https://api.guair.app
NEXT_PUBLIC_APP_NAME=Guair.app
NEXT_PUBLIC_APP_VERSION=1.0.0

# =============================================================================
# DATABASE CONFIGURATION (PCI-DSS 3.4, 8.2.1)
# =============================================================================

# PostgreSQL Connection - NEVER commit actual credentials
# Use AWS Secrets Manager, HashiCorp Vault, or similar in production
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=SCHEMA
DATABASE_URL=postgresql://username:password@localhost:5432/guair_db?schema=public

# Database SSL Configuration (Required in production)
DATABASE_SSL_ENABLED=true
DATABASE_SSL_REJECT_UNAUTHORIZED=true

# Connection Pool Settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# =============================================================================
# AUTHENTICATION & SESSION (PCI-DSS 8.2, 8.3)
# =============================================================================

# NextAuth Secret - MUST be generated using: openssl rand -base64 32
# NEVER use the example value in production
NEXTAUTH_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING_MIN_256_BITS
NEXTAUTH_URL=https://guair.app

# Session Configuration (PCI-DSS 8.2.5)
SESSION_TIMEOUT_MINUTES=15
SESSION_ABSOLUTE_TIMEOUT_HOURS=8

# Password Pepper (Additional security layer - PCI-DSS 8.2.1)
# Generate using: openssl rand -hex 32
PASSWORD_PEPPER=REPLACE_WITH_SECURE_RANDOM_HEX_64_CHARS

# =============================================================================
# CRYPTOGRAPHY (PCI-DSS 3.4, 3.5, 3.6)
# =============================================================================

# Encryption Keys - Use AWS KMS or similar in production
# Generate using: openssl rand -hex 32
ENCRYPTION_KEY=REPLACE_WITH_32_BYTE_HEX_KEY
ENCRYPTION_ALGORITHM=aes-256-gcm

# HMAC Secret for data integrity (PCI-DSS 10.5.2)
AUDIT_LOG_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING
PAYMENT_HMAC_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING

# =============================================================================
# RATE LIMITING (PCI-DSS 8.2.4)
# =============================================================================

# Redis Configuration (for production rate limiting)
REDIS_URL=redis://localhost:6379
REDIS_TLS_ENABLED=true

# Rate Limit Settings
RATE_LIMIT_LOGIN_MAX_ATTEMPTS=5
RATE_LIMIT_LOGIN_WINDOW_MINUTES=15
RATE_LIMIT_API_MAX_REQUESTS=100
RATE_LIMIT_API_WINDOW_MINUTES=1

# =============================================================================
# LOGGING & MONITORING (PCI-DSS 10)
# =============================================================================

# Log Level
LOG_LEVEL=info

# External Logging
ENABLE_EXTERNAL_LOGGING=true
SYSLOG_ENABLED=false
SYSLOG_HOST=
SYSLOG_PORT=514

# ELK Stack
ELK_ENABLED=false
ELASTICSEARCH_URL=

# Sentry (Error Monitoring)
SENTRY_DSN=
SENTRY_ENVIRONMENT=production

# =============================================================================
# SECURITY HEADERS & CSP (PCI-DSS 6.5.10)
# =============================================================================

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=/api/csp-report

# CORS Configuration
CORS_ALLOWED_ORIGINS=https://guair.app,https://www.guair.app
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE
CORS_MAX_AGE=86400

# =============================================================================
# PAYMENT PROCESSING (PCI-DSS Specific)
# =============================================================================

# Payment Service Provider Credentials
# NEVER store actual card data - use tokenization
PSP_API_KEY=
PSP_API_SECRET=
PSP_WEBHOOK_SECRET=

# Tokenization Service
TOKENIZATION_SERVICE_URL=
TOKENIZATION_API_KEY=

# =============================================================================
# EMAIL & NOTIFICATIONS
# =============================================================================

# SMTP Configuration
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=
SMTP_PASSWORD=

# SendGrid (Alternative)
SENDGRID_API_KEY=

# =============================================================================
# SMS & 2FA (PCI-DSS 8.3.1)
# =============================================================================

# Twilio Configuration
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# =============================================================================
# AWS SERVICES (Production)
# =============================================================================

# AWS Credentials (Use IAM roles in production, not static credentials)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# S3 Configuration
AWS_S3_BUCKET=guair-app-storage
AWS_S3_REGION=us-east-1

# Secrets Manager
AWS_SECRETS_MANAGER_ENABLED=true

# CloudWatch
AWS_CLOUDWATCH_ENABLED=true
AWS_CLOUDWATCH_LOG_GROUP=/aws/guair-app

# =============================================================================
# SECURITY FEATURES
# =============================================================================

# Account Lockout (PCI-DSS 8.2.4)
ACCOUNT_LOCKOUT_THRESHOLD=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=30

# MFA Configuration
MFA_ENABLED=true
MFA_ISSUER=Guair.app

# IP Whitelisting (for admin access)
ADMIN_IP_WHITELIST=

# Security Headers
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# =============================================================================
# COMPLIANCE & AUDIT
# =============================================================================

# Audit Log Retention (PCI-DSS 10.7 - minimum 365 days)
AUDIT_LOG_RETENTION_DAYS=365

# Data Retention
TRANSACTION_RETENTION_DAYS=2555  # 7 years
USER_DATA_RETENTION_DAYS=2555

# =============================================================================
# DEVELOPMENT ONLY (Remove in production)
# =============================================================================

# Prisma
DATABASE_LOGGING=false
PRISMA_CLI_BINARY_TARGETS=native

# Debug
DEBUG=false
VERBOSE_LOGGING=false

# =============================================================================
# FEATURE FLAGS
# =============================================================================

FEATURE_MFA=true
FEATURE_BIOMETRIC_AUTH=false
FEATURE_OFFLINE_MODE=false

# =============================================================================
# NOTES
# =============================================================================

# 1. NEVER commit actual credentials to version control
# 2. Use secrets management service in production (AWS Secrets Manager, Vault)
# 3. Rotate all secrets regularly (minimum every 90 days - PCI-DSS 8.2.4)
# 4. Generate strong random values using: openssl rand -base64 32
# 5. Enable MFA for all admin and payment processing accounts
# 6. Review and update this configuration during security audits
